"use strict";define(function(require,exports,module){var $=require("jquery"),common=require("js/common");require("js/bootstrapValidator.sea")($),require("js/LoadMask")($);var Navagator=require("js/Navagator"),NavMenu=require("js/NavMenu"),Bottom=require("js/Bottom"),Toolbar=require("js/Toolbar"),Alert=require("js/Alert"),Forgotpass=React.createClass({displayName:"Forgotpass",showAlert:function(){$(this.refs.myModal).modal()},lockRandom:function(time){var target=$(".getRandom"),time=time;if(0==time&&$.cookie("getRandom")&&(time=$.cookie("getRandom")),0!=time){target.prop("disabled","disabled"),target.val("("+time+")后重发"),$.cookie("getRandom",time,{expires:30});var inId=setInterval(function(){time--,target.val("("+time+")后重发"),$.cookie("getRandom",time,{expires:30}),0==time&&(target.val("获取动态码"),target.prop("disabled",!1),$.removeCookie("getRandom"),clearInterval(inId))},1e3)}},getRandom:function(){var me=this,form=$(".forgotpassForm").data("bootstrapValidator");form.validateField("mobile"),common.isValidField(form,"mobile")&&(me.lockRandom(60),$.ajax({url:common.createUrl($(".htmlbody").attr("data-getRandom-url")),data:{mobile:form.getFieldElements("mobile").val()},beforeSend:function(){$(".forgotpass").loadingOverlay()},success:function(data){$(".forgotpass").loadingOverlay("remove"),data.success?(me.setState({title:"消息",message:"动态码已通过发送到您的手机"}),me.showAlert()):(me.setState({title:"消息",message:data.message}),me.showAlert())},error:function(XMLHttpRequest,textStatus){$(".forgotpass").loadingOverlay("remove"),me.setState({title:textStatus,message:JSON.stringify(XMLHttpRequest)}),me.showAlert()},dataType:"json"}))},componentDidMount:function(){var me=this;me.lockRandom(0),$(".forgotpassForm").bootstrapValidator({message:common.regex.fail_text,feedbackIcons:{valid:common.feedbackIcons.valid,invalid:common.feedbackIcons.invalid,validating:common.feedbackIcons.validating}});var form=$(".forgotpassForm").data("bootstrapValidator");$(".submit").click(function(){form.isValid()&&$.ajax({url:common.createUrl($(".htmlbody").attr("data-forgotpass-url")),data:{},beforeSend:function(){$(".forgotpassForm").loadingOverlay()},success:function(data){$(".forgotpassForm").loadingOverlay("remove"),console.log(data),$(this.refs.checkpro).prop("checked")},error:function(XMLHttpRequest,textStatus){$(".forgotpassForm").loadingOverlay("remove"),me.setState({title:textStatus,message:JSON.stringify(XMLHttpRequest)}),me.showAlert()},dataType:"json"})})},getInitialState:function(){return{title:"消息",message:"..."}},render:function(){return React.createElement("div",{className:""},React.createElement(Navagator,null),React.createElement(NavMenu,{"data-index":"0"}),React.createElement("div",{className:"container forgotpass"},React.createElement("form",{className:"forgotpassForm form-horizontal center-block"},React.createElement("div",{className:"form-group"},React.createElement("label",{className:"title"},"欢迎来到91搭积木  找回密码")),React.createElement("div",{className:"form-group"},React.createElement("input",{type:"text",className:"form-control",name:"mobile",placeholder:"手机号","data-bv-notempty":"true","data-bv-notempty-message":common.regex.empty_text,"data-bv-regexp":"true","data-bv-regexp-regexp":common.regex.telephone_partten,"data-bv-regexp-message":common.regex.telephone_text})),React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-md-7 pl0"},React.createElement("input",{type:"text",className:"form-control",name:"random",placeholder:"手机效验码","data-bv-notempty":"true","data-bv-notempty-message":common.regex.empty_text,"data-bv-regexp":"true","data-bv-regexp-regexp":common.regex.random_partten,"data-bv-regexp-message":common.regex.random_text})),React.createElement("input",{type:"button",onClick:this.getRandom,className:"btn btn-default getRandom",value:"获取动态码"})),React.createElement("div",{className:"form-group"},React.createElement("button",{className:"btn btn-default submit"},"提交"),React.createElement("span",{className:"grayf"},"已有搭积木帐号?",React.createElement("a",{href:"/account/login.html"},"立即登录"))))),React.createElement(Bottom,null),React.createElement(Toolbar,null),React.createElement("div",{className:"modal fade",ref:"myModal",tabIndex:"-1",role:"dialog"},React.createElement(Alert,{title:this.state.title,message:this.state.message})))}});$(function(){ReactDOM.render(React.createElement(Forgotpass,null),$(".htmlbody").get(0))})});